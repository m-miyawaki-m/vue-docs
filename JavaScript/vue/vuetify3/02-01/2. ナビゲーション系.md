了解しました。Vuetify 3 のナビゲーション系コンポーネント（v-app-bar、v-navigation-drawer、v-tabs、v-toolbar）について、各コンポーネントごとの研究テンプレートを作成します。構成要素としては主なProps、Slots、Events、使用パターン、応用テクニック、注意点などを含めて詳しく調査し、わかりやすく整理します。

調査が完了次第お届けしますので、少々お待ちください。


# Vuetify 3 ナビゲーション系コンポーネント研究テンプレート

## v-app-bar（アプリケーションバー）

**公式ドキュメント**: [v-app-bar (Vuetify公式)](https://vuetifyjs.com/en/components/app-bars/)

### 基本説明と主な用途

`v-app-bar`（アプリケーションバー）は、アプリの最上部に配置されるツールバーで、一般的に**サイト全体のナビゲーションの起点**となる重要なコンポーネントです。ロゴやタイトル、主要なメニュー（ハンバーガーメニュー等）、検索ボックス、ユーザーアクションボタン（通知やアカウント）などを配置します。通常、`v-navigation-drawer`（サイドナビ）と組み合わせて使用され、画面上部に固定してグローバルなナビゲーションや機能アクセスを提供します。Vuetify 3では`v-app-bar`はデフォルトでレイアウトに組み込まれ、スクロール連動など**高度な振る舞い**にも対応しています。

### 主な Props 一覧（説明付き）

* **color** (`String`)：背景色を指定します（例: `color="primary"`）。テーマの色名やCSSカラーコードが利用可能です。
* **theme** (`String`)：このコンポーネントと子孫に適用するテーマを指定します（例: `theme="dark"`）。Vuetify 3では従来の`dark`プロパティの代わりに`theme`プロパティでダーク/ライトを切り替えます。
* **flat** (`Boolean`)：デフォルトのボックスシャドウを除去してフラットな外観にします。
* **elevation** (`Number`)：紙片のような浮き上がり効果の深度を0〜24で指定します。`elevation="0"`でフラットに、`elevation="4"`などでシャドウを付与します。
* **height** (`String|Number`)：バーの高さを明示的に指定します。指定しない場合は通常約64px（デフォルトの高さ）になります。他の高さ関連プロップ（denseやprominentなど）より優先されます。
* **density** (`String`)：バーの垂直方向の密度（高さの基準）を調整します。指定可能な値は `'default'`（デフォルト高さ）, `'comfortable'`（やや高め）, `'compact'`（やや低め）, `'prominent'`（特に高くする）です。たとえば`density="compact"`で高さが低くなり、`density="prominent"`で高さが大きくなります。
* **prominent** (`Boolean`)：高さを通常より高くする**プロミネント表示**。Vuetify 3では`density="prominent"`に統合されていますが、一部後方互換のため`prominent`も使用可能です。
* **extended** (`Boolean`)：アプリバーを拡張して高さを増やします。追加コンテンツを表示する際に使用し、`extensionHeight`と組み合わせて高さ調整が可能です（※extensionスロットを使わず高さだけ増やしたい場合に有用）。
* **extensionHeight** (`String|Number`)：`extension`スロット部分の高さを指定します（デフォルト48px）。拡張エリアの高さをカスタマイズできます。
* **image** (`String`)：バーの背景画像として表示する画像のURLを指定します。内部的に`v-img`コンポーネントとして表示され、`image`スロットでカスタマイズ可能です。
* **title** (`String`)：アプリバーに表示するタイトル文字列を指定します。`v-toolbar-title`コンポーネントを使わず手軽にタイトルを設定できます。
* **location** (`String`)：バーの表示位置を指定します。`"top"`(デフォルト)または`"bottom"`が選択可能で、ボトムナビゲーションバーのようにフッター側に配置することもできます。
* **absolute** (`Boolean`)：CSSの`position: absolute`を適用し、親要素内で絶対配置にします。レイアウトから独立させたい場合に使用します（通常はアプリ全体のトップに固定するため指定不要です）。
* **collapse** (`Boolean`)：バーを折りたたんだ状態にし、**横幅を狭く**します。アプリバーをサイドに配置する特殊なケースやレイアウト調整用です（使用頻度は高くありません）。
* **rounded** (`Boolean|String|Number`)：バーの角丸を指定します（trueで標準の角丸、`0`で直角、`'lg'`などプリセットも可）。
* **border** (`Boolean|String`)：バーに境界線を付けます。`border="bottom"`のように位置指定も可能です。
* **model-value(v-model)** (`Boolean`)：**バーの表示/非表示状態**をバインドできます。デフォルト`true`で表示。`false`にするとバーを非表示にできます。スクロール連動で自動的に更新されたり、カスタムロジックで切替える際に利用します。
* **order** (`Number|String`)：レイアウト内での表示順序を調整します。通常はDOMの定義順で配置されますが、複数のレイアウト要素の順序を入れ替えたい場合に指定します（例：`order="1"`など）。

※ **スクロール関連のプロップ**：Vuetify 3の`v-app-bar`では、スクロール時の挙動を制御するプロップ群が統合されました。公式には **`scroll-behavior`** というカスタムプロップで設定し、`hide`, `fully-hide`, `inverted`, `collapse`, `elevate` などのキーワードをスペース区切りで組み合わせ指定します（例：`scroll-behavior="hide elevate"`）。さらに **`scroll-threshold`**（数値ピクセル値）でスクロール量の閾値、**`scroll-target`**（要素のセレクタや`HTMLElement`）でスクロール監視対象を指定可能です。これらは公式ドキュメントに記載されています。

### 利用可能な Slots（あれば）

* **default**：アプリバー本体のコンテンツを配置するデフォルトスロットです。通常、ロゴやタイトル、ナビゲーションボタン類（例えばハンバーガーメニューアイコンやアクションボタン）をここに配置します。
* **prepend**：バーの先頭（左側）にコンテンツを追加するためのスロットです。デフォルトスロット内の先頭に位置し、主コンテンツの外側に要素を配置できます（主にアイコンボタン等を想定）。
* **append**：バーの末尾（右側）にコンテンツを追加するためのスロットです。デフォルトスロット内の末尾に位置し、例えば追加のメニューやボタンを配置できます。
* **title**：タイトル部分のコンテンツを差し替えるスロットです。`title`プロップで設定する文字列ではなく、独自のタイトル表示（例えばロゴ画像とテキストの組み合わせ等）を行いたい場合に使用します。
* **image**：背景画像用のスロットです。`image`プロップではなく自前で`v-img`等を配置したい場合に利用します。
* **extension**：拡張領域用のスロットです。バーの下部に拡張コンテンツを表示できます。例えばタブメニュー（`v-tabs`）を配置したり、検索フォームなどをバー直下に追加する際に使用します。高さは`extensionHeight`プロップで調整可能です。

### 主な Events（あれば）

* **@update\:modelValue**：`v-model`（modelValue）が変化した際に発火します。引数で新しいBoolean値（表示=true/非表示=false）が渡されます。スクロールによる自動変化時や、プログラム的にモデルを切り替えた際に捕捉できます。
* **（その他）**: クリックやキーボードイベントなどは通常のVueイベント修飾子（`@click`など）で子要素（ボタン等）に対して使用します。`v-app-bar`自身に固有のイベントは上記モデル更新以外特にありません。

### よくある使用パターンとコード例

* **基本的な固定ヘッダー**：アプリ全体の固定ヘッダーとして使うケースです。例えばロゴ・タイトル、ページ遷移ボタンや検索アイコン、プロフィールアイコン等を配置します。以下はシンプルな例です。

```vue
<template>
  <v-app>
    <v-app-bar color="primary" density="comfortable">
      <!-- ナビゲーションドロワーを開くボタン -->
      <v-app-bar-nav-icon @click="drawerOpen = !drawerOpen" />
      <!-- タイトル -->
      <v-toolbar-title>アプリ名</v-toolbar-title>
      <v-spacer></v-spacer>
      <!-- 右側のアクションボタン例 -->
      <v-btn icon><v-icon>mdi-magnify</v-icon></v-btn>
      <v-btn icon><v-icon>mdi-account-circle</v-icon></v-btn>
    </v-app-bar>
    <!-- ナビゲーションドロワーやメインコンテンツは省略 -->
  </v-app>
</template>

<script setup>
import { ref } from 'vue';
const drawerOpen = ref(false);
</script>
```

上記では`v-app-bar-nav-icon`を配置し、クリックで`drawerOpen`の状態をトグルしています。このボタンは通常「ハンバーガーメニュー」アイコン（三本線）で表示され、`v-navigation-drawer`と連携してドロワーを開閉するのに使われます。

* **スクロールに応じた動作**：ページスクロール時にヘッダーを隠したり縮小させたい場合、`scroll-behavior`関連のプロップを使用します。例えば「スクロールダウンでヘッダー非表示、スクロールアップで再表示」の基本パターンは以下です（Vuetify 3.3以降）。

```vue
<v-app-bar scroll-behavior="hide" scroll-threshold="100" />
```

このように設定すると、ユーザーが100px以上スクロールした時にヘッダー（defaultスロット部分）が上方向に隠れ、スクロールを逆方向（上方向）に動かすと再度表示されます。さらに`scroll-behavior="hide elevate"`のように組み合わせると、非表示になるまでの間徐々にエレベーション（影）が変化する効果も付与できます。

* **拡張領域の利用**：アプリバーにタブなどの二段構成メニューを組み込む場合、`extension`スロットを活用します。下記はアプリバーの下にタブを配置する例です。

```vue
<v-app-bar color="primary" dark density="comfortable">
  <v-toolbar-title>タイトル</v-toolbar-title>
  <v-spacer></v-spacer>
  <!-- extensionスロットでタブを追加 -->
  <template v-slot:extension>
    <v-tabs model-value="activeTab" @update:modelValue="tabChanged">
      <v-tab v-for="tab in tabs" :key="tab">{{ tab }}</v-tab>
    </v-tabs>
  </template>
</v-app-bar>
```

このようにすると、タイトルの下にタブが表示され、一体化したヘッダーを構築できます。`extension`スロット内の内容は`extensionHeight`（デフォルト48px）分の高さを持ちます。例えば大きめのタブを置く場合は`extensionHeight`を調整してください。

* **テーマとカラーカスタマイズ**：`dark`テーマを適用したい場合、Vuetify 3では`<v-app-bar theme="dark">`のように指定します。また、`color`プロップでテーマ色（例: `primary`, `secondary`）やカスタムカラー（例: `#1976D2`）を設定可能です。必要に応じてテキスト色とのコントラストにも注意します（darkテーマ時は自動でテキストが明るくなるなどVuetifyが調整します）。

### 応用テクニック（レスポンシブ対応、連携、固定表示など）

* **レスポンシブ対応**：`v-app-bar`自体はレスポンシブデザインにおいて特別な設定をしなくても動作しますが、**コンテンツの配置**に工夫が必要です。例えばタイトル文字が長い場合や、多数のアイコンボタンを配置する場合は画面幅によってレイアウトを調整します。Vuetifyのレイアウトユーティリティ（例えば`v-spacer`や表示切替クラス`d-{breakpoint}-{display}`）を使い、狭い画面では一部のボタンを隠す等の対応が一般的です。また、ナビゲーションドロワーと組み合わせ、モバイルではドロワーメニューを利用し、デスクトップではツールバー上にメニュー項目を並べるといった切替も考慮します。

* **ナビゲーションドロワーとの連携**：先述の通り、`v-app-bar-nav-icon`を配置して`@click`イベントで`v-navigation-drawer`の開閉状態（通常は`v-model`にバインドしたデータ）を変更するのが典型です。これによりモバイル画面など狭い幅ではハンバーガーメニューでドロワーをトグルし、広い画面ではドロワーを常時表示するといったUIを構築できます。Vuetify 3では`v-app-bar`や`v-navigation-drawer`をレイアウトシステム（`v-app`コンテナ）に配置するだけで、**画面サイズに応じた表示**（デスクトップではドロワー表示、モバイルでは自動的に隠す等）をかなり簡単に実現できます。詳細は後述の`v-navigation-drawer`のテンプレートで説明します。

* **複数のツールバー/アプリバーの固定**：アプリによってはメインのアプリバーの下にもう1つツールバー（フィルタバー等）を固定表示したり、逆にフッター側にアプリバー（ボトムナビゲーションのような）を配置するケースもあります。Vuetify 3では、レイアウト内に追加の`v-app-bar`や`v-toolbar`を配置することで対応できます。ただし**配置順序**に注意が必要です。Vuetify 3のレイアウトはコンポーネントの宣言順にレイアウト領域を割り当てるため、例えば`v-navigation-drawer`と`v-app-bar`を両方使う場合、どちらを先に書くかで表示レイヤーが異なります。通常、トップにフル幅でアプリバーを置きたい場合は`v-app-bar`を先に宣言し、その後に`v-navigation-drawer`を宣言します（こうするとアプリバーが最上部に配置され、ドロワーはその下に来ます）。逆にドロワーを先に書くと、ドロワーが上部レイヤーで配置されアプリバーの一部を押し出す形になります。複数のバーを扱う際はこの挙動を踏まえ、必要なら`order`プロップで順序を強制できます。

* **固定表示**：`v-app-bar`を常に固定表示するには特別な設定は不要で、`v-app`内に配置すれば自動的に固定レイアウトとして扱われます（Vuetify 2のような`app`プロップは不要になりました）。スクロールしてもアプリバーが画面上部に留まるのが基本挙動です。もしページ内の特定スクロールコンテナに対して相対的に動かしたい場合は、`absolute`プロップを付与してそのコンテナ内での絶対位置にすることもできます。

### よくある落とし穴や注意点

* **v-appコンテナの配置**：Vuetifyのレイアウトシステムでは、`v-app-bar`や`v-navigation-drawer`などは必ず`v-app`内に配置してください。`<v-app>`でラップしないと正しくレイアウト計算されず、固定表示やコンテンツとの連携が機能しないことがあります。また、`v-main`コンポーネントも`v-app-bar`直下（`v-navigation-drawer`と並列）に置く必要があります。この構造を守らないと、スクロールの検知やレイアウトサイズ計算に不具合が出る可能性があります。

* **スクロール連動の不具合**：`scroll-behavior`や`hide-on-scroll`相当の機能を使う際、\*\*スクロール対象要素（scroll-target）\*\*を正しく指定しないと期待通り動作しません。デフォルトでは`v-main`のスクロールを監視しますが、場合によってはwindow全体になることもあります。シングルページアプリケーションでビューが切り替わる場合など、スクロール位置リセットのタイミングによってはアプリバーが表示されたままになることもあります。必要に応じて`scroll-target`にカスタムセレクタ（例：`scroll-target="#scrolling-container"`）を指定してください。また、十分スクロールしないページ（コンテンツが短い場合）では`hide`動作が発動しないため、見た目上動作していないように見える点にも注意しましょう。

* **コンポーネントの重なり順**：複数のレイアウトコンポーネント（特にアプリバーとドロワー）を使用する際、前述の順序によるレイアウト決定のほかに、\*\*重なり（z-index）\*\*にも気を配る必要があります。例えば、ダイアログやメニュー (`v-menu`) が開いた際にアプリバーより前面に出るかどうかです。通常、Vuetifyは適切に処理しますが、もしアプリバーがメニューより前面に出てメニューを隠してしまう場合、z-indexを手動で調整する必要があります（CSSで`.v-app-bar`に対して`z-index`を指定）。Vuetifyのpropsでは制御できない部分なので注意してください。

* **v-toolbarとの混同**：`v-app-bar`は`v-toolbar`と似ていますが、**スクロール時の振る舞い**や**レイアウトへの影響**が異なります。`v-app-bar`はアプリケーション全体のヘッダー向けで、通常1ページに1つだけ使用します。一方、`v-toolbar`はページ内で複数配置可能な汎用ツールバーです。`v-app-bar`には`scroll-behavior`や`extension`など専用の機能がある反面、`v-toolbar`はシンプルなコンテナとして使われます。使い分けを誤ると意図しない見た目や動作になるので、「グローバルナビゲーションにはv-app-bar、局所的なツールバーにはv-toolbar」と覚えておきましょう。

---

## v-navigation-drawer（ナビゲーションドロワー）

**公式ドキュメント**: [v-navigation-drawer (Vuetify公式)](https://vuetifyjs.com/en/components/navigation-drawers/)

### 基本説明と主な用途

`v-navigation-drawer`（ナビゲーションドロワー）は、アプリのサイド（画面の左右どちらか）からスライド表示されるメニューコンテナです。ユーザーがアプリ内を移動する際に利用するリンク一覧やナビゲーションメニューを格納します。Vue Routerと組み合わせてページ遷移リンクを配置する場合にも、そのまま使えるよう**ルーター対応**が組み込まれています。一般的にアプリケーションでは、`v-app-bar`と共に`v-navigation-drawer`を画面の左（または右）に配置し、主要なページへのリンク（アイコンとテキストのリスト）を表示します。画面サイズに応じてモバイルでは隠れてハンバーガーメニューから開閉、デスクトップでは常時表示といった動作を取ることが多いです。

### 主な Props 一覧（説明付き）

* **model-value(v-model)** (`Boolean`)：ドロワーの開閉状態を制御します。`true`で開いた状態、`false`で閉じた状態になります。ユーザーの操作（スワイプや外側のスクリーン部分クリック）やコードからの変更で状態が切り替わり、バインドした変数に反映されます。
* **location** (`String`)：表示するサイド（位置）を指定します。`"left"`（デフォルト）または`"right"`が利用できます。以前のVuetify 2の`right`プロップに相当し、`location="right"`とすると画面右側からスライドするドロワーになります。
* **permanent** (`Boolean`)：常に表示状態にするかを指定します。`true`にすると画面サイズや`v-model`の値に関わらずドロワーが常時表示され、オーバーレイ（スクリーン）も表示されません（=固定表示）。`false`の場合は通常`v-model`で開閉制御し、モバイルでは閉じた初期状態にするのが一般的です。
* **temporary** (`Boolean`)：一時的なドロワーとして扱うかを指定します。Vuetify 3では`permanent=false`のドロワーは自動的に一時的（オーバーレイ付き）として扱われるため、明示的に指定しなくても同様の挙動になります。このプロップを指定することで強制的にモバイル表示用のスタイル/挙動にすることも可能です。
* **rail** (`Boolean`)：ドロワーを\*\*レール表示（ミニバリアント）\*\*にするかを指定します。`rail=true`の場合、ドロワーは幅の狭いアイコンのみの表示（ミニ状態）になり、ホバーまたは明示的なトグルでフル幅に展開できます。デスクトップレイアウトでよく使われ、メニューをアイコンだけで表示し省スペース化する用途です。
* **rail-width** (`Number|String`)：レール（ミニバリアント）時の幅を指定します（ピクセル単位）。指定しない場合はデフォルトで56px程度になります。アイコンが収まるサイズでカスタマイズ可能です。
* **expand-on-hover** (`Boolean`)：`rail`が有効な時、マウスホバーで自動的にドロワーをフルサイズに展開するかを指定します。`true`にすると、ユーザーがドロワー上にカーソルを載せた際に一時的に展開し、外れると自動でまた縮小します。デスクトップでのユーザビリティ向上に有用です。
* **width** (`Number|String`)：ドロワーの横幅を指定します（ピクセルまたはCSS幅指定）。デフォルトはおよそ256pxです。アプリのデザインに応じて狭めたり広げたりできます。
* **mini-variant-width** (`Number|String`)：（Vuetify 2からの後方互換）ミニバリアント時の幅を指定します。Vuetify 3では`rail-width`に相当しますが、このプロパティ名もサポートされている場合があります。通常は`rail-width`を使用します。
* **scrim** (`Boolean|String`)：ドロワーが開いている時に画面残り部分に表示される\*\*オーバーレイ（スクリーン）\*\*を制御します。`true`（デフォルト）で半透明の暗いスクリーンが表示され、クリックするとドロワーを閉じます。`false`にするとスクリーンを表示しません。また文字列で色（例: `scrim="#00000080"`）を指定して色や透明度を変えることも可能です。
* **clipped** (`Boolean`)*(Vuetify 2から変更)*：Vuetify 3では`v-app-bar`に対してドロワーを「クリップ」する（重ねて表示する）プロパティは削除されました。そのため、Vuetify 2の`clipped`に該当する動作は、レイアウト順序やCSSで対処します（詳しくは後述の応用テクニック参照）。もしVuetify 2から移行してきた場合、このプロパティは無視される点に注意してください。
* **elevation** (`Number`)：ドロワーのエレベーション（影の深さ）を0〜24で指定します。例えば`elevation="1"`でわずかな影、`0`でフラットにできます。
* **border** (`Boolean|String`)：ドロワーの境界線を表示します。`true`で全周、`"right"`等で特定辺にのみ線を引けます（デフォルトはコンテンツとの仕切りとして右境界線1pxが表示されます。Vuetify 3ではデフォルトの境界線有無はテーマによります）。
* **image / src** (`String`)：ドロワーの背景画像を設定します。`src`プロップに画像URLを指定すると、内部で`v-img`が背景として配置されます。例えばユーザーのプロフィール画像やカスタム背景をドロワー上部に表示したい場合に利用できます。細かい`v-img`のプロップ制御が必要な場合は`img`スロットを使って実装します。
* **temporary**: （上記参照。Vuetify 3では`v-model`制御時は実質一時的ドロワーとなるため省略）

### 利用可能な Slots（あれば）

* **default**：ドロワー内のメインコンテンツを配置するスロットです。一般的には`v-list`や`v-list-item`を用いてナビゲーションメニュー項目を配置します。複数のリストやコンテンツを縦に並べる場合もこのスロット内で行います。
* **append**：ドロワーの**下部**にコンテンツを追加するスロットです。例えばログアウトボタンやバージョン表示など、メニュー項目リストの下に常設したい内容をここに置けます。スクロールしない部分として常に下端に表示されます。
* **prepend**：ドロワーの**上部**にコンテンツを差し込むスロットです（Vuetify 3でも使用可能なら、上部固定領域として機能します）。ロゴやユーザー名表示、アバター画像などをメニューリストの上に配置したい場合に使います。公式APIドキュメントでは言及がない場合もありますが、Vuetify 2では存在したためVuetify 3でも同様に使える可能性があります。
* **img**：`src`プロップで設定した背景画像用の`v-img`コンポーネントをカスタマイズするためのスロットです。例えば`<template v-slot:img>`内で`v-img`にプロップ（例えば`gradient`や`height`）を渡して細かく制御できます。

### 主な Events（あれば）

* **@update\:modelValue**：`v-model`（表示状態）が変化したときに発火します。引数にはBooleanで新しい状態（true=開, false=閉）が渡されます。ユーザー操作（外部クリックやスクリーン押下による自動クローズ等）で閉じられた場合にもこのイベントが発生するので、そこでログを取ったり他のUIと連動させることが可能です。
* **@update\:rail**：ドロワーのレール（ミニ状態）モードが変化したときに発火します。Vuetify 3では`rail`の状態を双方向バインド（v-model\:rail）することもでき、その更新イベントとして受け取れます。引数にはBooleanで`rail`の新しい状態が入ります（`true`=ミニ化、`false`=標準幅）。
* **@keydown.native** 等：ドロワー内でキー操作をハンドルする場合、ネイティブキーイベントを利用できます。例えばEscキーで明示的に閉じたい場合、`@keydown.esc.prevent="drawerOpen = false"`のようにバインドします。ただし標準でEscキー押下時にはVuetifyが`modelValue`をfalseにする挙動があるため、基本的には自前で処理する必要はありません。

### よくある使用パターンとコード例

* **基本的なドロワーメニュー**：画面左側に配置され、項目としてリストを持つサイドバーとしての利用です。以下は典型的なテンプレートです。

```vue
<template>
  <v-app>
    <!-- ナビゲーションドロワー -->
    <v-navigation-drawer v-model="drawerOpen" location="left" :permanent="isDesktop" :scrim="!isDesktop">
      <v-list dense nav>  <!-- nav属性でナビゲーションリストを示す -->
        <v-list-item v-for="item in menuItems" :key="item.text" :to="item.route" router>
          <v-list-item-icon><v-icon :icon="item.icon"></v-icon></v-list-item-icon>
          <v-list-item-title>{{ item.text }}</v-list-item-title>
        </v-list-item>
      </v-list>
      <!-- 下部固定の追加コンテンツ -->
      <template v-slot:append>
        <v-divider></v-divider>
        <v-btn text @click="logout">ログアウト</v-btn>
      </template>
    </v-navigation-drawer>

    <!-- アプリケーションバー -->
    <v-app-bar color="primary">
      <v-app-bar-nav-icon @click="drawerOpen = !drawerOpen" />
      <v-toolbar-title>タイトル</v-toolbar-title>
    </v-app-bar>

    <!-- メインコンテンツ -->
    <v-main>
      <router-view></router-view>
    </v-main>
  </v-app>
</template>

<script setup>
import { ref, computed } from 'vue';
const drawerOpen = ref(false);
const menuItems = ref([
  { text: 'ホーム', icon: 'mdi-home', route: '/' },
  { text: '設定', icon: 'mdi-cog', route: '/settings' },
]);
const isDesktop = computed(() => window.innerWidth > 960);
const logout = () => { /* ログアウト処理 */ };
</script>
```

上記コードでは、`v-navigation-drawer`を左側に配置し、`v-list-item`に`to`属性を指定することでVue Routerのリンクとして機能させています（`router`プロップを付与することで`<router-link>`として扱われます）。また、`isDesktop`が`true`の場合は`permanent`（常に表示）とし、モバイル時には`temporary`扱いでスクリーン（`scrim`）付きの開閉式になるようにしています。`v-app-bar-nav-icon`のクリックで`drawerOpen`をトグルし、ハンバーガーメニューによる開閉を実現しています。`v-list`に`nav`プロパティを付けることで適切なリストスタイル（選択状態のハイライト等）が適用されます。

* **ミニバリアント（Rail）モード**：デスクトップ画面で、ドロワーを細いアイコンのみのバーとして表示し、必要時に拡大するUIです。例えば以下のように実装します。

```vue
<v-navigation-drawer v-model="drawerOpen" rail v-if="isDesktop" @mouseenter="hovering = true" @mouseleave="hovering = false" :rail-width="72" expand-on-hover>
  <!-- ドロワー内容 -->
</v-navigation-drawer>
```

ここで`rail`プロップを指定すると、`drawerOpen=true`のときでも幅が狭い状態（アイコンのみ表示）になります。`expand-on-hover`を付けると、マウスホバー（mouseenter）で自動展開し、外れると閉じます。上記のように手動で`@mouseenter/@mouseleave`をハンドリングすれば、必要に応じてデータ（例：hovering）で状態管理もできます。ミニバリアントの**幅**は`rail-width`（ここでは72px）で指定しています。デフォルト56pxですが、アイコン＋αのスペースが必要なら少し広げることも可能です。

* **モバイルでの自動振る舞い**：Vuetifyのナビゲーションドロワーは、`v-model`に`null`を初期指定すると**モバイルでは閉、デスクトップでは開**で開始するという便利な挙動がありました（Vuetify 2の場合）。Vuetify 3では明示的に`permanent`や`temporary`を切り替える構成になっていますが、Composition API等で画面幅を監視し`permanent`プロップをバインドすることで同様のレスポンシブ制御が可能です。上記例コードでも`isDesktop`を算出し`permanent`に適用しています。なお、**レスポンシブに応じた自動開閉**をVuetifyに任せたい場合、`v-responsive`コンポーネントや`v-display`のComposable（Vuetify提供の画面サイズ検知）を利用するとよりスマートです。

* **リスト項目の構成**：ドロワー内では`v-list`と`v-list-item`を用いてメニューを構成することが多いです。`v-list-item`に`to`と`router`を指定することで、Vue Routerのリンクとして機能させています。また`v-list-item-icon`や`v-list-item-title`でアイコンとテキストを整形しています。この構成はお決まりのパターンなので、必要に応じて**共通レイアウトとしてコンポーネント化**しておくと便利です。

* **ドロワー内のヘッダー/フッター**：`prepend`や`append`スロットを使って、ドロワー内の上下に固定表示のコンテンツを置けます。例えば上部にユーザー情報（アバターと名前）を表示し、下部に設定ボタンを置くなどが考えられます。これらの部分はメニュー項目リストとは独立して固定表示されるため、スクロールするメニューが長くても常に見える状態を保てます。

### 応用テクニック（レスポンシブ対応、連携、固定表示など）

* **アプリバーとのレイアウト連携**：`v-navigation-drawer`は`v-app-bar`との相互配置で挙動が変わります。Vuetify 3では、前述したように宣言順序でレイアウトが決定され、基本的に**先に書かれた方が上に配置**されます。例えば、アプリバーを先に、その後にドロワーを書くと、アプリバーが画面上部にフル幅で配置され、その下にドロワー＋メインコンテンツが並ぶ形になります。一方、ドロワーを先に宣言すると、ドロワーは画面左上から表示され、続いて書かれるアプリバーはドロワーの右側の残りのスペースに配置されます（まるでアプリバーがドロワーによって押し出されているようなレイアウト）。一般的なレイアウトでは**アプリバーを先に**宣言する方法が選ばれます。なお、この順序とは別に、`order`プロップで表示順を強制的に変更できますが、通常はDOM順で十分でしょう。

* **クリップ（重なり）挙動**：Vuetify 2では`clipped`系プロップで「ドロワーがアプリバーに重なって表示され、アプリバーの内容（タイトルなど）を押し出さない」設定が可能でした。Vuetify 3では明示的な対応がないため、同じ見た目を再現するにはCSSで`.v-navigation-drawer`要素に`margin-top: -64px`（アプリバーの高さ分上に重ねる）を適用したり、アプリバーを絶対配置にして重ね合わせる、といった工夫が必要になります。現時点でv3において**アプリバーとドロワーのオーバーラップ**は標準機能でサポートされていないので、この点はデザイン上の割り切りが必要です。

* **外側クリックによる自動クローズ**：モバイルモードなど一時的ドロワーが開いている際、ユーザーがドロワー外（スクリーン部分）をクリックするとドロワーが閉じます。これは`scrim`がデフォルトで有効なためで、特に実装を追加しなくても動作します。逆に、ドロワーを開いたままにしたい特殊なケースでは`scrim="false"`とすることでオーバーレイを出さず、外側クリックでは閉じないようにできます。ただしユーザー体験上、モバイルでは外側タップで閉じれないと戸惑う可能性があるため、scrim無効は慎重に使用してください。また、オーバーレイを出さない代わりに\*\*ハードウェアのBackボタン（Android）\*\*で閉じる動作を実装するなどUX面での補填を検討しましょう。

* **スワイプ操作**：モバイルにおいて、画面端からスワイプしてドロワーを開閉するジェスチャーをサポートすることも可能です。Vuetifyは標準で**タッチ操作**による開閉をある程度サポートしています。特に、モバイルデバイスで左端から右にスワイプするとドロワーが開く挙動が既定で有効になっている場合があります（ブラウザやSPA構成によります）。必要に応じて、より詳細な制御をするには、タッチイベントを自前で検知して`drawerOpen`を切り替える実装や、ライブラリを用いたスワイプ対応を検討してください。

* **開閉のトランジション**：ドロワーの開閉にはVuetifyがデフォルトのトランジション（滑らかなアニメーション）を適用しています。もしトランジション効果を変更・無効化したい場合、内部で使用されている`v-slide-x-transition`コンポーネントのプロパティを上書きする方法があります。Vuetify 3ではグローバルなトランジション設定や、一部コンポーネントで`transition`プロップの指定が可能です。ドロワー直接ではサポートしていないかもしれませんが、調整が必要ならCSSで`.v-navigation-drawer`のトランジションを制御することもできます。例えば開閉を即時にしたい場合、`.v-navigation-drawer { transition: none !important; }`を当てるなど。ただしUX観点ではデフォルトのアニメーションを維持するのが無難でしょう。

### よくある落とし穴や注意点

* **レイアウトのバグ**：`v-navigation-drawer`を使う際、`v-app`内の構造を正しくしないと、メインコンテンツ（`v-main`）のサイズや位置が崩れることがあります。例えば`v-main`をドロワー内に入れてしまったり、`v-app-bar`と`v-navigation-drawer`をネストして書いてしまうケースです。必ず`v-app`直下に並列で`v-app-bar`・`v-navigation-drawer`・`v-main`を配置するようにしましょう（順序は前述の通りです）。レイアウトが崩れた場合はDOM構造を再確認してください。

* **permanentとtemporaryの混同**：画面幅によって`permanent`と`temporary`（または`v-model`制御）を切り替える実装をする際、ロジックの整合性に注意しましょう。例えばデスクトップで`permanent=true`だったドロワーがその状態で表示されている時に画面を縮小した場合、一旦`permanent`を`false`に変更して`drawerOpen`も適切に閉じる必要があります。これを怠ると、狭い画面でもドロワーが開きっぱなしになったり、逆に広い画面で意図せず閉じたままになることがあります。Vueのリアクティブな`computed`や`watch`で画面幅を監視し、状態を適切に遷移させるようにしましょう。

* **アイコンのみの表示**：レール（ミニモード）時にはアイコンだけが表示されテキストが省略されますが、デフォルトでは**最初のメニュー項目**のみツールチップなど無しでフル表示される仕様（Vuetify 2でのデフォルト挙動）でした。Vuetify 3でも似た仕様の場合、1番目の項目が意図せず常時見えてしまう可能性があります。必要に応じて`mini-variant`（rail）モード時には全項目アイコンのみにするか、ツールチップを各`v-list-item`に付与してテキストをホバー時に見せるなど、ユーザビリティを補いましょう。

* **外部コンテンツとの干渉**：スクロール可能なコンテンツや地図などと組み合わせる際、ドロワーのオーバーレイが正しく動作しないことがあります。例えばGoogle Mapsのドラッグ操作がスクリーン（scrim）に阻まれるなどです。こうした場合は、ドロワーを一時的に`temporary=false`にするか、地図表示中のみドロワーを強制閉鎖する処理を入れるなど、UIフローに応じた対策が必要です。

* **コンポーネントの再利用**：レイアウトの都合上、`v-navigation-drawer`をレイアウトコンポーネントとして別ファイルに分割し、メインのレイアウトにインポートするケースがあります。その際、Vueの再レンダリングでドロワーの開閉状態がリセットされてしまうことに注意してください（ページ遷移でレイアウトが再作成されると`v-model`が初期化されるなど）。可能であればルーター上でレイアウトコンポーネントを保持（再利用）するか、状態をグローバルストアに持つなどして、ページ間でドロワーの開閉状態を引き継ぐ工夫をすると、よりシームレスなUXになります。

---

## v-tabs（タブ）

**公式ドキュメント**: [v-tabs (Vuetify公式)](https://vuetifyjs.com/en/components/tabs/)

### 基本説明と主な用途

`v-tabs`コンポーネントは、**タブ切り替えによってコンテンツを隠し表示する**ためのUI部品です。複数のセクションやページを単一画面で切り替える目的で使用され、ユーザーにとって関連する内容グループをコンパクトにまとめることができます。例えば設定画面の「一般」「詳細」タブや、プロフィール画面の「投稿」「返信」切り替えなどによく使われます。また、タブ自体をページ遷移用のナビゲーションとして利用する（タブをクリックするとルーターで別ページに遷移する）ことも可能で、この場合**擬似的なナビゲーションメニュー**として機能します。

Vuetifyの`v-tabs`はVueの`v-item-group`を拡張したコンポーネントで、タブ（`v-tab`）とタブコンテンツ（`v-tabs-items`内の`v-tab-item`）を組み合わせて使用します。タブを選択すると対応するコンテンツが表示され、他は非表示になる仕組みです。

### 主な Props 一覧（説明付き）

* **model-value(v-model)** (`Number|String`)：現在選択されているタブを識別する値です。タブのインデックス（0,1,2…）やタブに割り当てた識別子をバインドします。例えば`v-model="activeTab"`として`activeTab`にインデックス番号を格納することで、タブ選択を制御・取得できます。`update:modelValue`イベントによってタブ変更を検知可能です。
* **fixed-tabs** (`Boolean`)：タブの幅を固定サイズにします。有効にすると各タブ（`v-tab`）は最小160px・最大300pxの幅で均等に配置されます（デフォルト）。画面幅に応じて可能な限り均等にスペースを取るため、タブ数が少ない場合でも一定の幅を保持します。
* **grow** (`Boolean`)：タブを可能な限り均等に伸長させます。`fixed-tabs`に似ていますが、こちらは**余白も含めて全幅を占有**するよう各タブを拡大します。タブ数が少ない場合、各タブが最大300pxまで広がり、それでも余白があれば等分して広がります。例えば2つのタブしか無い場合でも、コンテナ幅全体に広がるため見栄えが良くなります。
* **center-active** (`Boolean`)：有効にすると**常にアクティブなタブをコンテナ中央に表示**します。タブがスクロール可能（オーバーフロー）な場合、選択変更時にアクティブタブが自動的に中央にスクロールされます。多数のタブを横スクロールで表示する場合に、ユーザーが選択中のタブを見失わないようにする効果があります。
* **background-color** (`String`)：タブコンテナの背景色を指定します（例: `background-color="primary"`）。`color`プロップではなく`background-color`である点に注意です。Vuetify 3では単に`color`プロップとして統一されている可能性もありますが、公式ドキュメントでは`v-tabs`専用に背景色指定できるようになっています。
* **slider-color** (`String`)：アクティブタブ下のスライダー（横線）の色を指定します。デフォルトでは現在のテーマの強調色（primaryなど）が使われます。`slider-color="orange"`のように設定するとアクティブを示す線の色が変わります。
* **hide-slider** (`Boolean`)：アクティブタブ下のスライダー（横線）を非表示にします。タブ切替時の下線エフェクトが不要な場合に指定します。
* **icons-and-text** (`Boolean`)：有効にすると、アイコンとテキストを併せ持つタブ表示用にタブの高さが自動的に大きく（72px程度）なります。タブ内に`v-icon`とテキスト両方を入れる場合にレイアウトが崩れないよう高さを確保するためのプロップです。手動でCSSを調整しなくてもこのプロップ一つで対応できます。
* **right** (`Boolean`)：タブの位置を右寄せにします。デフォルトでは左寄せ（または`center-active`等で中央）ですが、右側にタブをまとめたい場合に指定します。例えばウィンドウの右端にタブを配置して、その左側に別のコンテンツを置くようなレイアウトに有用です。
* **vertical** (`Boolean`)：縦型のタブレイアウトにします。有効にすると`v-tabs`コンポーネント自体が垂直方向に展開し、`v-tab`も縦に積み重なって表示されます。合わせて`v-tabs-items`も横スライドではなく縦切替になります。サイドバー形式のタブメニューを作りたい場合に利用します。
* **mandatory** (`Boolean`)：少なくとも一つのタブを必ず選択状態にするかどうかを指定します。Vuetify 3ではデフォルトで`mandatory`（必須選択）がtrueになっており、必ずどれか1つはアクティブになる挙動です。falseにすると全タブ非選択も可能になりますが、通常タブUIでは使わないでしょう。

### 利用可能な Slots（あれば）

* **default**：タブ（`v-tab`コンポーネント）を配置するためのデフォルトスロットです。`v-tabs`の子要素として複数の`v-tab`を置くことでタブのリストを定義します。`v-tab`以外にも`v-spacer`を入れてタブ群の間に余白を作ることも可能です。
* **prev** / **next**：（名称は推測）タブがスクロール可能な量を超えた場合、左右に表示されるページネーション矢印をカスタマイズするためのスロットが用意されている可能性があります。Vuetify 2では`prev-icon`と`next-icon`プロップでアイコンを指定しましたが、Vuetify 3ではスロットでアイコンボタンを差し替え可能かもしれません。公式APIにスロット明記が無い場合は、プロップでの指定のみとなります。
* **extension**：（Vuetify 2の`v-toolbar`に存在したtabs propに相当）`v-tabs`を`v-app-bar`や`v-toolbar`内で使う場合、親側の`extension`スロットに入れる形になります。`v-tabs`自身のスロットではありませんが、よく親コンポーネントの特定領域に組み込まれるため、設置場所に注意が必要です。

### 主な Events（あれば）

* **@update\:modelValue**：現在選択中のタブが変更されたときに発火します。引数には新しいタブの識別値（インデックスや指定した値）が渡されます。タブ切替を検知して他の処理をしたい場合に利用します。
* **@change**：(Vuetify 2で存在した) 同様にタブ変更時のイベントですが、Vuetify 3では`update:modelValue`に集約されている可能性があります。必要に応じてこちらを利用してください。
* **タブ項目 (`v-tab`) のイベント**：各`v-tab`は内部的にボタン要素なので、`@click`などを直接書くよりも`v-model`経由でハンドリングするのが普通です。ただし、中身にカスタムな要素を入れて独自クリック処理をしたい場合は、子要素側でイベントを捕捉してください。

### よくある使用パターンとコード例

* **基本的なタブとコンテンツの切替**：もっとも一般的なのは、`v-tabs`と`v-tabs-items`を組み合わせ、ユーザーのタブ選択に応じて異なる内容を表示するパターンです。

```vue
<template>
  <!-- タブの定義 -->
  <v-tabs v-model="activeTab" background-color="primary" dark fixed-tabs>
    <v-tab v-for="tab in tabs" :key="tab">{{ tab }}</v-tab>
  </v-tabs>

  <!-- タブコンテンツの定義 -->
  <v-tabs-items v-model="activeTab">
    <v-tab-item v-for="(tab, index) in tabs" :key="tab">
      <div class="pa-4">コンテンツ {{ index + 1 }}: {{ tab }} の内容</div>
    </v-tab-item>
  </v-tabs-items>
</template>

<script setup>
import { ref } from 'vue';
const tabs = ref(['タブ1', 'タブ2', 'タブ3']);
const activeTab = ref(0);
</script>
```

この例では、`activeTab`という`ref`変数を`v-tabs`と`v-tabs-items`双方にバインドし（同期させ）ています。初期値0により最初のタブが選択状態となり、それに対応する`v-tab-item`内のコンテンツ（"コンテンツ 1"）が表示されます。タブをクリックすると`activeTab`の値が変更され、対応するコンテンツが表示されます。`fixed-tabs`を指定しているため、各タブは均等な幅で配置されます。また`dark`テーマと背景色primaryを与えて、典型的なカラースキームにしています。

* **アイコン付きのタブ**：タブにアイコンを表示する場合、`v-tab`の中で`v-icon`とテキストを一緒に書きます。例えば:

```vue
<v-tabs v-model="tab" icons-and-text>
  <v-tab><v-icon left>mdi-home</v-icon>ホーム</v-tab>
  <v-tab><v-icon left>mdi-account</v-icon>プロフィール</v-tab>
  <v-tab><v-icon left>mdi-settings</v-icon>設定</v-tab>
</v-tabs>
```

`icons-and-text`プロップを付けることで高さが確保され、アイコンとテキストが縦に中央揃えで配置されます。`<v-icon left>`を用いるとアイコンがテキストの左に配置され少し右マージンが付くため見栄えが良くなります（Vuetifyの仕様で`left`/`right`属性によりアイコンに適切な余白が付与されます）。アイコンとテキストを縦方向に積み重ねたい場合は、単に改行を入れるかCSSで`.v-tab { flex-direction: column; }`を指定することで可能ですが、一般的には横並びが推奨です。

* **スクロール可能な大量のタブ**：タブの数が多くコンテナ幅を超える場合、タブは自動的に横スクロール可能になります。この時、Vuetifyはデスクトップでは左右にページネーション用の矢印アイコンを表示し、モバイルではデフォルト非表示（必要に応じ`show-arrows`プロップで明示表示）となります。大量のタブを扱う場合は`center-active`を有効にして選択タブが見切れないようにしたり、`show-arrows`プロップで常に矢印を表示するなど検討してください。なお、**スワイプ操作**でタブコンテンツを切り替えることも可能です（`v-tabs-items`に`touchless`や`swipeable`といったプロップがある場合）。Vuetify 2では`swipeable`でスワイプ切替できましたが、Vuetify 3では公式ドキュメントを確認してください。

* **ルーターと併用したタブ**：タブをページ遷移のナビゲーションとして使う場合、2通りの方法があります。

  1. **`v-tab`に`to`プロップを使う方法**：各`v-tab`にVue Routerの`to`を指定し、`router`プロップを付けます。こうすると`<router-link>`のように振る舞い、タブをクリックすると対応するページに遷移します。この場合`v-tabs`の`v-model`は使わず、選択状態のハイライトはVue Routerがマッチしたリンクに自動適用します。ただしVuetify 3で`v-tab`が`router-link`対応しているか要確認です（Vuetify 2では可能でした）。
  2. **`v-model`で監視し`router.push`する方法**：タブのインデックスやキーを`v-model`で管理し、`@update:modelValue`イベントで対応するルートへ`router.push`します。こうするとタブとルーティングが明確に切り離されます。この方法では、ページ読み込み時に現在のルートに応じて`activeTab`を設定する処理も必要です。

  いずれの方法でも、**タブ切替時のコンテンツ表示**は`router-view`に任せることになり、`v-tabs-items`は使用しません。したがって`v-tabs`単体で利用する形になります。ルーターリンクとしてのタブ利用は、例えばアプリ上部の`v-app-bar`内に配置してページ間のナビゲーションとする場合に有用です。

* **縦型タブ**：`vertical`プロップを使うと、タブを縦に並べることができます。例えばサイドバーのように左側にタブ、右側に内容を表示するUIが作れます。この場合、`v-tabs`自体が縦長のコンテナとなり、`v-tabs-items`も縦方向のスライド（またはフェード）でコンテンツを切り替えるようになります。実装時は、`v-tabs`と`v-tabs-items`を例えば`v-row`で左右に並べて配置すると良いでしょう。注意点として、縦タブではタブの横幅が固定されるため、タブラベルが長いと幅を広めに取る必要があります（`width`を指定するかCSS調整）。

### 応用テクニック（レスポンシブ対応、連携、固定表示など）

* **ツールバーやアプリバーへの組み込み**：タブを`v-app-bar`や`v-toolbar`の中に入れ、ページ上部のメニューとして利用することができます。典型的には、`v-app-bar`の`extension`スロットに`v-tabs`を入れ込む方法です（前述のv-app-barの応用テクニック参照）。Vuetify 2では`v-toolbar`に`tabs`プロップを付けると高さがタブ用に自動調整されましたが、Vuetify 3ではおそらく存在しないため、自身で適切な密度（density）やスタイルを設定してください。タブをバー内に置くとき、**タブの横幅**がバーと合わず中途半端になる場合は`grow`や`fixed-tabs`で調整します。また、バー内に配置するとバーと背景色が同化するため、`v-tabs`側に明示的に`background-color`を与えるか、バーと同じ色を使うようにしましょう。

* **タブ切替アニメーション**：`v-tabs-items`は内部で`v-window`コンポーネントを使用しており、デフォルトでスライド（横方向移動）のトランジションが設定されています。これを変更したい場合、例えばフェード切替にするには`v-tabs-items`に`transition="fade-transition"`のようなプロップを指定します。Vuetifyには用意されたトランジション名（例えば`fade-transition`や`scale-transition`）があるので活用できます。あるいは`v-window`の`reverse`プロップを操作して逆向きのスライドにするなど高度な設定も可能です。タブの切替効果はUXに影響するので、必要に応じて微調整しましょう。

* **非表示タブのバリデーション**：タブコンテンツ内にフォームなどがあり、非表示のタブ内にも必須入力項目がある場合の注意です。VueとVuetifyでは非表示（未レンダリング）状態のコンテンツは初期状態ではバリデーションしません。しかし、例えば「次へ」ボタン押下時に全タブのフォームを検証したい場合、未表示タブにも検証が必要です。その際は`v-tab-item`に`eager`プロップを付けて非表示タブもDOMに描画させておく必要があります。`eager`を付けると全タブコンテンツが一度にレンダリングされ、非アクティブでもバリデーションや計算が行えます。ただしその分初期ロードが重くなるので、必要な場合にのみ付与してください。

* **タブの動的追加・削除**：`v-tabs`のタブ項目を動的に増減させる場合、キー指定に注意します。上記例では`v-for`に`key=tab`（名前）を使用していましたが、タブ名が重複しないならそれで問題ありません。重複や名前変更の可能性がある場合、ユニークIDを持つデータに基づいて`key`を指定しましょう。動的変更時、現在選択中の`activeTab`のインデックスがずれる可能性があるため、例えば後ろのタブを削除した際は`activeTab`が不正な値とならないよう範囲内に収める処理を入れることも必要です。

* **タブ項目のカスタムコンポーネント**：標準の`v-tab`ではなく、より複雑なタブラベル（例えば通知数バッジ付きのタブなど）を実装したい場合、`v-tab`内部に自由な内容を記述すれば対応できます。`v-tab`は基本的にボタン要素なので、中に<div>等を入れてレイアウトできます。ただし高さやpaddingが既定と違ってくるため、自前でスタイル調整が必要になります。場合によっては完全にカスタムしたタブボタンコンポーネントを`v-tabs`の代わりに並べ、自分で選択管理するという手法もありますが、`v-tabs`の機能（スライダーやキーボード操作など）を再現するのは大変なので、基本は`v-tab`を拡張する形で考えてください。

### よくある落とし穴や注意点

* **`v-tabs-items`の配置忘れ**：タブをクリックしても何も起こらない場合、対応する`v-tabs-items`/`v-tab-item`を配置していない可能性があります。`v-tabs`でタブUI自体はできても、コンテンツを切り替えるには`v-tabs-items`との組み合わせが必要です。忘れずに用意しましょう。また`v-tabs-items`は`v-tabs`と同じ階層に置く必要があります（同じ`v-app`内であれば位置は自由ですが、一般的にはすぐ下に書く方が分かりやすいです）。

* **`v-model`の型**：`v-tabs`の`v-model`は数値インデックスか文字列キーをとります。一度文字列キー（例えばタブ名）でバインドした後、誤って数値を代入すると一致しなくなります。例えば`activeTab = "Settings"`から`activeTab = 1`のように型が変わるのは不整合です。同じ型で管理しましょう。特にルーター連携でタブ名（パス名）をキーに使う場合など、意図しない型変換が起きないよう注意してください。

* **overflow時の矢印**：タブ数が多い場合に表示されるページネーション矢印（prev/next）が**クリックできない**場合、`v-tabs`のコンテナ幅や`position: relative`などスタイルの干渉が考えられます。Vuetifyの実装上、矢印は`v-tabs`内のスロットにレンダリングされますが、親要素に`overflow: hidden`が掛かっていると表示されない/押せないことがあります。カスタムCSSを当てている場合は確認しましょう。またモバイル表示で矢印が出ないのは仕様です。強制的に出したい場合は`show-arrows`プロップを付けてください。

* **キーボード操作**：タブは左右キーで移動、Enter/Spaceで選択などキーボード操作が可能です。もしカスタム実装により`v-tab`ではなく独自ボタンでタブを作ると、このキーボードナビゲーションが効かなくなります。アクセシビリティの点からも、`v-tab`を使用する限りVuetifyが適切にARIA属性やキーボード操作を処理してくれるので、独自実装する場合は同等の配慮をしましょう。

* **タブコンテンツの遅延読み込み**：大量のデータを含むタブコンテンツを持つ場合、`eager`を付けると全タブを初期レンダリングするためパフォーマンスに影響があります。一方`eager`を付けない場合、切り替え時に遷移アニメーション中に遅延読み込みで若干のタイムラグが生じることがあります。必要に応じて各タブコンポーネント内部でデータをフェッチし、タブがアクティブになったタイミングでロードを始めるなど工夫が要ります。また、タブを切り替えてもコンポーネントの状態を保持したい場合（例えばフォームの入力途中で他タブを見ても戻ったら続きが残っている）、デフォルトでは非表示タブは非活性化されている間状態が維持されますが、タブ自体の再レンダリングは起こっていないか確認しましょう。万一状態が失われる場合は、`<KeepAlive>`でラップするなどVue側の機能も検討してください。

---

## v-toolbar（ツールバー）

**公式ドキュメント**: [v-toolbar (Vuetify公式)](https://vuetifyjs.com/en/components/toolbars/)

### 基本説明と主な用途

`v-toolbar`は、アプリ内の**汎用的なバーコンテナ**で、ヘッダーやサブヘッダー、フッターなど様々な場所で使われます。`v-app-bar`がアプリ全体のナビゲーションバーであるのに対し、`v-toolbar`はページ内セクションの見出しや、一時的なフィルターバー、カードのタイトル部など**複数配置可能**なバーとして利用します。例えば、リスト画面で項目のフィルターや検索を提供する上部バーや、ダイアログ内のタイトルバー、カードのヘッダー部分などに`v-toolbar`が適しています。一つの画面に複数のツールバーを置くことも問題ありません。

見た目は`v-app-bar`と類似しており、テキストやボタン、アイコン等を横一列に配置できます。ただし、`v-toolbar`は`v-app-bar`のようなスクロール連動機能や固定レイアウトへの影響力は持っていません。その分シンプルで軽量なので、目的に応じて使い分けます。

### 主な Props 一覧（説明付き）

* **color** (`String`)：ツールバーの背景色を指定します。`v-app-bar`同様にVuetifyテーマの色名や任意のカラーコードが使用できます。例えば`color="grey lighten-4"`で薄いグレー背景、`color="primary"`でテーマのプライマリ色背景となります。
* **variant** (`String`)：ツールバーのスタイルバリアントを指定します。Vuetify 3ではボタンなどで`variant="tonal"`などを指定できますが、`v-toolbar`でも`variant="outlined"`や`"plain"`などが使用できるか確認が必要です（公式Docに記載があれば追従）。基本的には`flat`（シャドウ無）や`elevated`（シャドウ有）を切り替えるシンプルなプロップとして考えてください。
* **flat** (`Boolean`)：ボックスシャドウを除去し、フラットな見た目にします（`v-app-bar`と共通のプロップ）。`variant="flat"`と同等の効果です。
* **elevation** (`Number`)：影の深さ（z軸）を0〜24で指定します。他のコンポーネント同様、0でシャドウなし、数値が大きいほど濃い影になります。例えばページスクロールに追従するサブヘッダーを`elevation="2"`で少し浮かせる、といった使い方が可能です。
* **height** (`String|Number`)：ツールバーの高さを明示的に指定します。デフォルトは約64px（またはdense時48px）です。コンテンツ量に応じて高さを変えたい場合に指定します。例えば小型アイコンのみのツールバーなら`height="48"`などとできます。
* **density** (`String`)：垂直方向の密度（高さ基準）を設定します。`default`（通常高さ）、`comfortable`（やや高い）、`compact`（やや低い）の値が指定できます。実質的に`dense`（compact相当）を指定する用途です。`dense`プロップも後方互換で存在するかもしれませんが、Vuetify 3ではdensityに統合されています。
* **title** (`String`)：ツールバーに表示するタイトル文字列。`<v-toolbar-title>`スロットを使わず手軽にタイトルを設定したい場合に使用します。例えば`title="ユーザー一覧"`のように指定すれば、自動的にタイトル用のスタイルが適用されたテキストが表示されます。
* **image** (`String`)：背景画像を設定します。`v-app-bar`同様にツールバー背景に画像を敷けますが、一般的なユースケースではあまり用いません（主にv-app-bar向けの機能です）。
* **border** (`Boolean|String`)：ツールバーの境界線表示。`border="bottom"`とすると下端にラインを引けます。サブヘッダーを他のコンテンツと区切る場合などに便利です。
* **rounded** (`Boolean|String|Number`)：ツールバーの角丸を指定します。通常ツールバーはフル幅なので角丸効果は目立ちませんが、部分的に使う場合に指定します。
* **absolute** (`Boolean`)：`position: absolute`を適用し、親要素内での絶対配置にします。例えばカード内のツールバーをカードの中で絶対的に上に被せたいようなケースに使います。レイアウトを崩さないために注意して使います。
* **sticky** (`Boolean`)：CSSの`position: sticky`を適用し、ページスクロール時にその位置で固定するようにします。例えば長いリストの見出しツールバーをスクロールに追従させたい場合に使えます。対応ブラウザでは、親要素のスクロール領域内で自身が上端に達したら固定されます。
* **bottom** (`Boolean`)：ツールバーをコンテナの下端に配置します。例えばモバイル画面でボトムバーとしてツールバーを使いたい場合に有効です。`position: fixed`やabsoluteと組み合わせて画面下部に貼り付ける用途もあります。

### 利用可能な Slots（あれば）

* **default**：ツールバー内のコンテンツを配置するためのデフォルトスロットです。ここにボタンやタイトル、ドロップダウンなど任意の要素を配置します。一般的にレイアウトとしては左側にタイトル（または戻るボタン）、中央付近にタブや検索バー、右側にアクションボタン（メニューや設定）といった配置を行うことが多いです。
* **title**：ツールバータイトル用のスロットです。`v-toolbar-title`コンポーネントを使う代わりに、`<template v-slot:title>`内に独自のタイトル要素を配置できます。例えばタイトル部分をクリック可能にしたい場合に、自前の`<router-link>`でラップしたタイトルを置くことができます（`v-toolbar-title`ではなくなるのでスタイルは自分で調整）。
* **extension**：Vuetify 3の`v-toolbar`に`extension`スロットがあるかは未確認ですが、`v-app-bar`には存在しました。もし`v-toolbar`にもあれば、ツールバー下に拡張コンテンツを表示できます。ただ通常`v-toolbar`ではextensionはなく、必要なら`v-app-bar`を使うことが推奨されます。

### 主な Events（あれば）

* **@click\:prepend** / **@click\:append**：もし`v-toolbar`が`v-app-bar`と同様にprepend/appendスロットに対応している場合、その領域をクリックしたイベントを拾える可能性があります。一般的にはツールバー自体より、中のボタンに対して直接`@click`を指定することが多いでしょう。
* **@scroll**：`position: sticky`やカスタムスクロール検知をしたい場合、親コンテナに`@scroll`イベントハンドラを付ける必要があります。`v-toolbar`自体にはスクロールイベントはありません（スクロールしない要素なので）。
* **その他**：`v-toolbar`はコンテナ要素なので、イベントは中のコンポーネントで扱います。たとえば戻るボタン（v-btn）を配置して`@click="goBack"`のようにしたり、メニュー（v-menu）を配置してそのイベントを処理する形になります。`v-toolbar`固有のイベントはありません。

### よくある使用パターンとコード例

* **ページサブヘッダー**：メインのアプリバーの下に、ページ固有の機能を持つサブヘッダーとしてツールバーを置くケースです。例えば一覧ページでフィルタボタンや並び替えドロップダウンを配置したり、詳細ページでタブを配置するバーとして使ったりします。

```vue
<v-toolbar color="grey lighten-4" dense>
  <v-toolbar-title>ユーザー一覧</v-toolbar-title>
  <v-spacer></v-spacer>
  <v-text-field dense solo-inverted placeholder="検索" prepend-inner-icon="mdi-magnify"></v-text-field>
  <v-btn text>フィルタ</v-btn>
  <v-btn icon><v-icon>mdi-dots-vertical</v-icon></v-btn>
</v-toolbar>
```

この例では薄いグレー背景のツールバー（denseモード）にタイトルと検索フィールド、フィルタボタン、メニューアイコンを配置しています。`dense`を付けて高さを詰めており、`v-text-field`も`dense solo-inverted`スタイルでツールバーに収まるようにしています。`v-spacer`でタイトルと検索フィールドの間を空け、右寄せ配置を実現しています。**ポイント**: `v-toolbar-title`は自動で適切なフォントサイズと余白を持つタイトル表示要素です。文字列プロップではなくスロットにプレーンテキストを書いてもOKですが、コンポーネントを使う方が統一感があります。

* **カードヘッダーとしての使用**：カード (`v-card`) の上部にタイトルやボタンを配置する場合にも`v-toolbar`が使えます。例えば:

```vue
<v-card>
  <v-toolbar flat color="primary" dark>
    <v-toolbar-title>カードタイトル</v-toolbar-title>
    <v-spacer></v-spacer>
    <v-btn icon><v-icon>mdi-refresh</v-icon></v-btn>
    <v-btn icon><v-icon>mdi-close</v-icon></v-btn>
  </v-toolbar>
  <v-card-text>...</v-card-text>
</v-card>
```

ここでは`v-card`内に`flat`な`v-toolbar`を配置し、カードと境界無くつながるヘッダーとしています。色をprimary・darkにしてカード全体のヘッダー感を出し、右上にリフレッシュと閉じるアイコンボタンを置いています。このように`v-toolbar`は他のコンポーネント内でヘッダー的に利用しても問題なく動作します。高さ調整や余白は適宜CSSで微調整してください。

* **フッターバー**：`v-toolbar`はフッターにも利用できます。例えばアプリの一番下にメニューを配置する場合、`position: fixed; bottom: 0; width: 100%`のスタイルを当てた`v-toolbar`を配置すれば実現できます。Vuetify 3には`v-bottom-navigation`コンポーネントもありますが、シンプルなフッターバーであれば`v-toolbar`＋`v-btn`の組合せで十分なことがあります。`bottom`プロップを付けることで`v-system-bar`との組み合わせ時に下寄せ配置が容易になるかもしれません（公式情報要確認）。

* **ツールバーアイテムの配置**：`v-toolbar-items`コンポーネントを活用すると、ツールバー内でボタン群をまとめて適切に配置できます。例えば:

```vue
<v-toolbar>
  <v-toolbar-title>設定</v-toolbar-title>
  <v-spacer></v-spacer>
  <v-toolbar-items>
    <v-btn text>保存</v-btn>
    <v-btn text>キャンセル</v-btn>
  </v-toolbar-items>
</v-toolbar>
```

`v-toolbar-items`は内部のボタンをフル高さに伸ばし、ツールバー内で縦中央に揃えてくれるラッパーです。これを使わず直接ボタンを書いた場合でも動作はしますが、ボタン同士の高さや間隔を整えるために`v-toolbar-items`を使うと便利です。特にアイコンボタンでない普通のテキストボタンをツールバーに置く場合、`v-toolbar-items`内に入れることで自動的に`flat`スタイル（背景なし）になります。そのため上記のように`text`（=flat）を明示していますが、Vuetifyが自動で適用してくれるケースもあります。

### 応用テクニック（レスポンシブ対応、連携、固定表示など）

* **スクロールに合わせた固定配置（sticky）**：`v-toolbar`に`sticky`プロップ（またはクラス`position-sticky`と適切なCSS）を与えることで、その親要素内でスクロール追従させることが可能です。例えば複数セクションからなるページで各セクションのヘッダーを`v-toolbar sticky`にすると、セクションが画面上部に来た時点でそのヘッダーが画面トップに貼り付き、次セクションまで固定表示されます。これはブラウザのネイティブ`position: sticky`を利用したもので、対応ブラウザであればスムーズに動作します。IE11など非対応ブラウザではフォールバックとして普通の静的な配置になりますが、モダンな環境であれば問題ないでしょう。

* **多段のツールバー**：`v-toolbar`自体は1段ですが、連続して複数のツールバーを縦に並べることで多段構成にできます。例えば、最上段にフィルタ項目、2段目にタブという場合、2つの`v-toolbar`をStackすれば実現可能です。それぞれに異なる色を付けたり、片方をdenseにするなど調整します。`v-app-bar`と異なり一体化する仕組み（extensionスロットなど）は無いので、単純に複数配置して見た目上繋げます。境界線を消したい場合は上のツールバーに`flat`を付け、下のツールバーに`flat`＋上境界線borderを付ける等デザインしてください。

* **メディアクエリに応じた表示切替**：ツールバー内の要素をレスポンシブに変化させるのもよくある手法です。例えば大画面ではテキストで「保存」「キャンセル」と表示し、小画面ではアイコンだけにするといった場合、Vuetifyの表示ユーティリティクラス（例: `d-none d-sm-flex`など）を活用すると簡単です。または2組のボタンを用意し、`$vuetify.display`（Vuetify 2の例）やComposition APIの`useDisplay()`から取得できるブレークポイント情報を元に`v-if`で出し分けることも可能です。`v-toolbar`自体が画面幅に応じて高さを変える（denseになる）ような機能は持たないので、必要なら`dense`プロップにブレークポイントを組み合わせた反応 (`:density="isMobile ? 'compact' : 'comfortable'"` のような) を自前で実装します。

* **ダイアログのタイトルバー**：ダイアログ (`v-dialog`) 内のタイトル部分に`v-toolbar`を流用することができます。例えばダイアログに閉じるボタン(X)を右上に置くには、単純にタイトル行にボタンを配置しても良いですが、`v-toolbar`にしておけば見た目の調整（paddingや高さ揃え）が楽です。`v-toolbar`に`flat`を付けて、色はデフォルト（透明）にすることで違和感なくダイアログヘッダーとして使えます。**注意**: ダイアログはポータル（body直下）に描画されるため、ツールバーの幅はダイアログコンテンツ幅に依存します。長いタイトルの場合は適宜CSSで`white-space: nowrap`を指定するなど調整してください。

* **コンポーネントとしての再利用**：共通のツールバー（例えばアプリ内の共通サブナビ）をコンポーネント化しておき、各ビューで再利用するのも良いでしょう。その際、柔軟性を持たせるためにスロットを活用します。例えばカスタムツールバーコンポーネントで内部に`<slot name="actions">`を用意し、子にボタン群を差し込めるようにすれば、画面ごとに異なるアクションを持つ共通デザインのツールバーを使い回せます。

### よくある落とし穴や注意点

* **`v-app-bar`との違い**：前述しましたが、`v-toolbar`と`v-app-bar`は似て非なるものです。**間違えて`v-app-bar`を複数配置しない**ようにしましょう。特に、`v-app-bar`はレイアウトコンポーネントなので1つの`v-app`内に複数置くとレイアウト計算が意図せず複雑になります（複数配置自体はできなくはないですが、基本1つ想定）。複数のバーが必要な場合は2つ目以降は`v-toolbar`で実装するのがセオリーです。Vuetifyの開発者からも「**グローバルナビにはv-app-bar、複数使用やセクション用にはv-toolbar**」というアドバイスがされています。

* **ボタンのサイズと余白**：`v-toolbar`内でアイコンボタンをそのまま配置すると、Vuetifyが自動で適切なスタイル（アイコンサイズを大きく、マイナスマージンで間隔調整）を適用します。しかし、例えば `<div>` でボタンをラップした場合その自動スタイルが当たらなくなり、見た目が崩れます。そのため、ツールバー内のボタンをラップする必要がある場合（権限によってボタンを出し分けるコンディショナルなwrapperなど）、ラッパー要素に適切なクラス（`.ma-n3`などネガティブマージンを付与）を当ててやる必要があります。もしくは`v-toolbar-items`を使ってラップするのが安全策です。

* **テキストの省略**：ツールバー内のタイトルが長い場合、デフォルトでは折り返しせずそのまま表示され、レイアウトを圧迫する可能性があります。`v-toolbar-title`はCSSで`white-space: nowrap`が指定されており、長いテキストははみ出します。必要なら明示的にスタイルを調整するか、タイトル部分をコンポーネント化して内部で省略（エリプシス: `text-overflow: ellipsis`）処理を行ってください。または`v-tooltip`等で全体を見せる工夫も考えられます。

* **モバイルでの高さ**：マテリアルデザインではツールバー（アプリバー）の高さはモバイルで56dp、デスクトップで64dpと定義されています。Vuetifyではこれを`dense`や通常モードで再現していますが、デザイン仕様を厳密に再現するなら画面サイズに応じてdensityを変えることも考えられます。ただ実際にはそれほど気にしなくても良いケースが多いです。もしデザインガイドラインに沿う必要がある場合は、自前で`@media`クエリを使い`.v-toolbar`の高さを調整するか、Vue側でpropsを切り替えてください。

* **表示崩れのデバッグ**：ツールバーはレイアウトの中核だけに、表示崩れが起こると目立ちます。例えばボタンが垂直中央に揃っていない、左右余白が不均一、といった場合はVuetify既定のクラスが正しく適用されているか確認しましょう。ブラウザ開発者ツールでツールバー内部構造（`.v-toolbar__content`やボタンのクラス）を確認し、どのCSSが干渉しているかを探ります。時には自分で書いたグローバルCSSがVuetifyのスタイルと競合していることもあります。その場合はスコープを限定するか、より具体的なセレクタで上書きするようにします。

以上、Vuetify 3のナビゲーション系コンポーネント4種（v-app-bar、v-navigation-drawer、v-tabs、v-toolbar）について、それぞれの概要と使い方、プロップやスロット、応用テクニック等をまとめました。公式ドキュメントにも詳細が記載されていますので、適宜参照してください（例えば各コンポーネントのAPIページでは全プロップ・スロットが網羅されています）。このテンプレートが開発・実装時の指針となれば幸いです。
