ã§ã¯ã€**Vuex / Pinia ã§ãƒšãƒ¼ã‚¸çŠ¶æ…‹ï¼ˆ`pageStates`ï¼‰ã‚’å‹•çš„ã«å–å¾—ã™ã‚‹ãŸã‚ã®ãƒ©ãƒƒãƒ‘ãƒ¼é–¢æ•°**ã‚’ç”¨æ„ã—ã¾ã—ã‚‡ã†ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå´ã¯ `"pageA"` ã®ã‚ˆã†ãªã‚­ãƒ¼åã ã‘ã‚’æ¸¡ã™ã ã‘ã§æ¸ˆã¿ã¾ã™ã€‚

---

## âœ… å‹•çš„çŠ¶æ…‹ã‚¢ã‚¯ã‚»ã‚¹ãƒ©ãƒƒãƒ‘ãƒ¼ï¼š`usePageState(key)`

### ğŸ”§ composables/usePageState.ts

```ts
import { computed } from 'vue'
import { usePageControlStore } from '@/store/modules/pageControl'

export const usePageState = (key: string) => {
  const store = usePageControlStore()

  const enabled = computed(() => store.pageStates[key])
  return { enabled }
}
```

---

## ğŸ’¡ ä½¿ç”¨ä¾‹ï¼ˆPageX.vueï¼‰

```ts
<script lang="ts">
import { defineComponent } from 'vue'
import { usePageState } from '@/composables/usePageState'

export default defineComponent({
  name: 'PageX',
  setup() {
    const { enabled } = usePageState('pageX')  // â† ã“ã“ã§ã‚­ãƒ¼ã‚’æŒ‡å®š

    return { enabled }
  }
})
</script>
```

```vue
<template>
  <div>
    <h3>ã“ã®ãƒšãƒ¼ã‚¸ã®çŠ¶æ…‹: {{ enabled ? 'ON' : 'OFF' }}</h3>
  </div>
</template>
```

---

## ğŸ›  è£œè¶³ï¼šå‹å®‰å…¨ã«ã—ãŸã„å ´åˆï¼ˆOptionalï¼‰

TypeScript ã§å‹ãƒã‚§ãƒƒã‚¯ã—ãŸã„å ´åˆã¯ã‚­ãƒ¼ã®å‹ã‚’åˆ¶é™ï¼š

```ts
type PageKey = 'pageA' | 'pageB_tab1' | 'pageC_table' | ... // æ˜ç¤ºçš„ã«å®šç¾©

export const usePageState = (key: PageKey) => {
  const store = usePageControlStore()
  const enabled = computed(() => store.pageStates[key])
  return { enabled }
}
```

---

## âœ… ãƒ¡ãƒªãƒƒãƒˆã¾ã¨ã‚

| é …ç›®         | å†…å®¹                           |
| ---------- | ---------------------------- |
| å†åˆ©ç”¨æ€§       | è¤‡æ•°ã®ãƒšãƒ¼ã‚¸ã§åŒã˜æ§‹æ–‡ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½           |
| ä¿å®ˆæ€§        | `pageStates` ã®æ§‹é€ ãŒå¤‰ã‚ã£ã¦ã‚‚ã“ã“ã ã‘ä¿®æ­£ |
| ãƒ†ã‚¹ãƒˆå®¹æ˜“      | `usePageState()` å˜ä½“ã§ãƒ†ã‚¹ãƒˆå¯èƒ½    |
| å‹ã®è¿½åŠ ã§å®‰å…¨æ€§UP | å¯¾å¿œã‚­ãƒ¼ä»¥å¤–ã®èª¤ä½¿ç”¨ã‚’é˜²æ­¢ã§ãã‚‹             |

---

ã”å¸Œæœ›ã‚ã‚Œã°ã€`useJsonLoader()` ã«ã‚‚ä¼¼ãŸã‚­ãƒ¼æ¸¡ã—æ–¹å¼ã«çµ±ä¸€ã§ãã¾ã™ã‚ˆã€‚ç¶šã‘ã¦æ•´å‚™ã—ã¾ã™ã‹ï¼Ÿ

äº†è§£ã—ã¾ã—ãŸã€‚
`useJsonLoader()` ã«ã‚‚ `key: string` ã‚’æ¸¡ã—ã¦ã€**ãƒšãƒ¼ã‚¸ã”ã¨ã«ç•°ãªã‚‹JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€æ±ç”¨ãƒ©ãƒƒãƒ‘ãƒ¼é–¢æ•°**ã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¾ã—ã‚‡ã†ã€‚

---

## âœ… æ”¹è‰¯ç‰ˆ `useJsonLoader(key: string)`

### ğŸ“ `composables/useJsonLoader.ts`

```ts
import { ref, watch } from 'vue'
import { usePageControlStore } from '@/store/modules/pageControl'

export function useJsonLoader(key: string) {
  const store = usePageControlStore()
  const data = ref<any[]>([])

  const loadData = async () => {
    try {
      const filename = store.currentJsonMap[key] || 'default.json'
      const response = await fetch(`/data/${filename}`)
      data.value = await response.json()
    } catch (err) {
      console.error(`ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å¤±æ•—: ${key}`, err)
      data.value = []
    }
  }

  watch(() => store.currentJsonMap[key], loadData, { immediate: true })

  return { data }
}
```

---

## âœ… Vuexï¼ˆã¾ãŸã¯ Piniaï¼‰å´ã®æ›´æ–°

```ts
// store/modules/pageControl.ts
export const usePageControlStore = defineStore('pageControl', {
  state: () => ({
    pageStates: {
      pageA: true,
      pageB: false,
      // ...ä»–ãƒšãƒ¼ã‚¸
    },
    currentJsonMap: {
      pageA: 'dataA.json',
      pageB: 'dataB.json',
      // ...åˆæœŸãƒãƒƒãƒ”ãƒ³ã‚°
    }
  }),
  actions: {
    setJson(key: string, filename: string) {
      this.currentJsonMap[key] = filename
    }
  }
})
```

---

## ğŸ’» ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ä½¿ã„æ–¹

```ts
<script lang="ts">
import { defineComponent } from 'vue'
import { usePageState } from '@/composables/usePageState'
import { useJsonLoader } from '@/composables/useJsonLoader'

export default defineComponent({
  name: 'PageA',
  setup() {
    const { enabled } = usePageState('pageA')
    const { data } = useJsonLoader('pageA')

    return { enabled, data }
  }
})
</script>
```

```vue
<template>
  <div v-if="enabled">
    <p>JSONãƒ‡ãƒ¼ã‚¿:</p>
    <ul>
      <li v-for="item in data" :key="item.id">{{ item.name }}</li>
    </ul>
  </div>
</template>
```

---

## âœ… ãƒ¡ãƒªãƒƒãƒˆã¾ã¨ã‚

| é …ç›®         | å†…å®¹                                           |
| ---------- | -------------------------------------------- |
| æ±ç”¨æ€§        | ãƒšãƒ¼ã‚¸å˜ä½ã§ key ã‚’æ¸¡ã™ã ã‘ã§è‡ªå‹•çš„ã«èª­ã¿è¾¼ã¿                    |
| æŸ”è»Ÿãªãƒ‡ãƒ¼ã‚¿å·®ã—æ›¿ãˆ | JSONåã¯ç®¡ç†ãƒšãƒ¼ã‚¸ã‹ã‚‰ `setJson(key, filename)` ã§å¤‰æ›´å¯èƒ½ |
| ã‚¨ãƒ©ãƒ¼è€æ€§      | èª­ã¿è¾¼ã¿å¤±æ•—æ™‚ã‚‚å®‰å…¨ã«ç©ºé…åˆ—ã§ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯                       |
| åŒä¸€æ§‹æ–‡ã®é©ç”¨æ€§   | `usePageState` ã¨æƒã£ãŸæ§‹æ–‡ã§ç¿’å¾—æ€§ãŒé«˜ã„                 |

---

å¿…è¦ã§ã‚ã‚Œã°ã€`default.json` ãªã©ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚„ã€ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã®è¿½åŠ ã€å‹ä»˜ããƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ä»•çµ„ã¿ã‚‚å¯¾å¿œã§ãã¾ã™ã€‚ç¶šã‘ã¦æ‹¡å¼µã—ã¾ã™ã‹ï¼Ÿ
ã‚ˆã„è¦–ç‚¹ã§ã™ï¼
\*\*JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å‹ä»˜ãï¼ˆTypeScriptã§å‹å®‰å…¨ï¼‰\*\*ã«ã™ã‚‹ã“ã¨ã§ã€è£œå®Œãƒ»èª¤ç”¨é˜²æ­¢ãƒ»ãƒ†ã‚¹ãƒˆã®å®‰å®šæ€§ãŒå¤§ããå‘ä¸Šã—ã¾ã™ã€‚

---

## âœ… ç›®çš„ï¼š`useJsonLoader<T>(key: string): { data: Ref<T[]> }` ã®ã‚ˆã†ãªå‹ä»˜ãå¯¾å¿œ

---

## ğŸ›  å®Ÿè£…æ‰‹é †ï¼šå‹ä»˜ã `useJsonLoader<T>()`

### ğŸ“ `composables/useJsonLoader.ts`

```ts
import { ref, Ref, watch } from 'vue'
import { usePageControlStore } from '@/store/modules/pageControl'

export function useJsonLoader<T = any>(key: string): { data: Ref<T[]> } {
  const store = usePageControlStore()
  const data = ref<T[]>([])

  const loadData = async () => {
    try {
      const filename = store.currentJsonMap[key] || 'default.json'
      const response = await fetch(`/data/${filename}`)
      const json = await response.json()
      data.value = json as T[]
    } catch (err) {
      console.error(`JSONèª­ã¿è¾¼ã¿å¤±æ•—: ${key}`, err)
      data.value = []
    }
  }

  watch(() => store.currentJsonMap[key], loadData, { immediate: true })

  return { data }
}
```

---

## âœ… ä½¿ç”¨ä¾‹ï¼ˆå‹å®šç¾©ã¨çµ„ã¿åˆã‚ã›ï¼‰

### ğŸ“ `types/PageAData.ts`

```ts
export interface PageAItem {
  id: number
  name: string
  age: number
}
```

### ğŸ“„ PageA.vue

```ts
<script lang="ts">
import { defineComponent } from 'vue'
import { usePageState } from '@/composables/usePageState'
import { useJsonLoader } from '@/composables/useJsonLoader'
import type { PageAItem } from '@/types/PageAData'

export default defineComponent({
  name: 'PageA',
  setup() {
    const { enabled } = usePageState('pageA')
    const { data } = useJsonLoader<PageAItem>('pageA')  // ğŸ” å‹ã‚’æŒ‡å®š

    return { enabled, data }
  }
})
</script>
```

```vue
<template>
  <div v-if="enabled">
    <ul>
      <li v-for="item in data" :key="item.id">
        {{ item.name }}ï¼ˆ{{ item.age }}æ­³ï¼‰
      </li>
    </ul>
  </div>
</template>
```

---

## ğŸ§  ãƒ¡ãƒªãƒƒãƒˆ

| ãƒ¡ãƒªãƒƒãƒˆ    | èª¬æ˜                                |
| ------- | --------------------------------- |
| å‹å®‰å…¨     | èª¤ã£ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã‚„å‹ãƒŸã‚¹ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«æ¤œå‡º           |
| ä¿å®ˆæ€§     | JSONæ§‹é€ ãŒå¤‰ã‚ã£ãŸã¨ãã®å½±éŸ¿ç®‡æ‰€ãŒæ˜ç¢º             |
| IDEæ”¯æ´å¼·åŒ– | `item.` ã¨æ‰“ã¤ã ã‘ã§è£œå®ŒãŒè¡¨ç¤ºã•ã‚Œã‚‹            |
| æ±ç”¨æ€§     | ä»–ã®ãƒšãƒ¼ã‚¸ã§ã‚‚ `<T>` ã‚’å¤‰ãˆã‚‹ã ã‘ã§å‹å®‰å…¨ãªèª­ã¿è¾¼ã¿ãŒã§ãã‚‹ |

---

## âœ… ã‚¹ãƒãƒ›ã‚³ãƒ”ãƒšã¾ã¨ã‚

```
ğŸ§© useJsonLoader<T>(key) ã§å‹ä»˜ããƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
ğŸ“„ å‹ã¯ interface ã§å®šç¾©ï¼ˆä¾‹ï¼šPageAItemï¼‰
ğŸ“¦ JSONã¯ pageControlStore.currentJsonMap ã§ç®¡ç†
ğŸ”„ watch ã«ã‚ˆã‚Šåˆ‡ã‚Šæ›¿ãˆã‚‚ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åæ˜ 
```

---

å¿…è¦ã§ã‚ã‚Œã° `fetch()` ã‚’ `axios.get<T[]>()` ã«åˆ‡ã‚Šæ›¿ãˆãŸã‚Šã€APIé¢¨ã«ã‚‚ã§ãã¾ã™ã€‚ã•ã‚‰ã«é€²ã‚ã¾ã™ã‹ï¼Ÿ
