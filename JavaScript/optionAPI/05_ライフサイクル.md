äº†è§£ã—ã¾ã—ãŸï¼Vue 3 + TypeScript + **ã‚ªãƒ—ã‚·ãƒ§ãƒ³APIï¼ˆdefineComponentï¼‰** ã«ãŠã‘ã‚‹ `ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ï¼ˆLifecycle Hooksï¼‰` ã®ä½¿ã„æ–¹ã‚’ã€ä½“ç³»çš„ã«æ•´ç†ã—ã¾ã™ã€‚

---

## âœ… 5. ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ï¼šVueã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç”Ÿå­˜æœŸé–“ã«å¿œã˜ãŸå‡¦ç†ã®ä»•è¾¼ã¿

Vueã§ã¯ã€**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒç”Ÿæˆã•ã‚Œã‚‹éç¨‹ã€œç ´æ£„ã•ã‚Œã‚‹ã¾ã§ã®å„ãƒ•ã‚§ãƒ¼ã‚ºã§å‡¦ç†ã‚’å®Ÿè¡Œ**ã§ãã¾ã™ã€‚

---

## âœ… ã‚ªãƒ—ã‚·ãƒ§ãƒ³APIã§ä½¿ãˆã‚‹ä¸»ãªãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ä¸€è¦§

| ãƒ•ãƒƒã‚¯å              | ã‚¿ã‚¤ãƒŸãƒ³ã‚°                         | ç”¨é€”ä¾‹                   |
| ----------------- | ----------------------------- | --------------------- |
| `beforeCreate()`  | data, props, computed ãªã©ã®åˆæœŸåŒ–å‰ | åˆæœŸåŒ–å‰ã®ãƒ­ã‚°ã€DIæº–å‚™ãªã©        |
| `created()`       | data, props ãŒä½¿ç”¨å¯èƒ½ã«ãªã‚‹ç›´å¾Œ        | éåŒæœŸåˆæœŸãƒ‡ãƒ¼ã‚¿å–å¾—ãªã©          |
| `beforeMount()`   | DOMã«ãƒã‚¦ãƒ³ãƒˆã•ã‚Œã‚‹ç›´å‰                 | ä»®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å‰ã®å‡¦ç†           |
| `mounted()`       | DOMã«ãƒã‚¦ãƒ³ãƒˆã•ã‚ŒãŸç›´å¾Œ                 | APIå‘¼ã³å‡ºã—ã€DOMæ“ä½œã€ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãªã© |
| `beforeUpdate()`  | å†æç”»ãŒå§‹ã¾ã‚‹ç›´å‰                     | æ›´æ–°ç›´å‰ã®æ¯”è¼ƒãƒ»ä¿å­˜ãªã©          |
| `updated()`       | å†æç”»ãŒå®Œäº†ã—ãŸç›´å¾Œ                    | è¡¨ç¤ºèª¿æ•´ã€DOMå†è¨ˆæ¸¬ãªã©         |
| `beforeUnmount()` | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç ´æ£„å‰                    | ãƒªã‚¹ãƒŠãƒ¼è§£é™¤ã€ä¿å­˜ãªã©           |
| `unmounted()`     | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç ´æ£„å¾Œ                    | ãƒ¡ãƒ¢ãƒªè§£æ”¾ã€ãƒ­ã‚°è¨˜éŒ²ãªã©          |

---

## âœ… ä½¿ç”¨ä¾‹ï¼š`mounted` ã¨ `beforeUnmount`

```ts
export default defineComponent({
  name: 'ExampleLifecycle',

  data() {
    return {
      timer: 0
    }
  },

  mounted() {
    console.log('ğŸŒ± mounted: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¾ã—ãŸ')
    this.timer = window.setInterval(() => {
      console.log('â± ã‚«ã‚¦ãƒ³ãƒˆä¸­')
    }, 1000)
  },

  beforeUnmount() {
    console.log('ğŸ§¹ beforeUnmount: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒç ´æ£„ã•ã‚Œã¾ã™')
    clearInterval(this.timer)
  }
})
```

---

## âœ… ã‚ˆãä½¿ã†ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« TOP 3

| ãƒ•ãƒƒã‚¯               | ä½¿ç”¨é »åº¦ | ä¸»ãªç”¨é€”                    |
| ----------------- | ---- | ----------------------- |
| `mounted()`       | â—    | åˆæœŸè¡¨ç¤ºãƒ»APIå–å¾—ãƒ»DOMåˆæœŸåŒ–       |
| `created()`       | â—‹    | éåŒæœŸå–å¾—ãƒ»VuexåˆæœŸåŒ–ãªã©ï¼ˆDOMæœªä½¿ç”¨ï¼‰ |
| `beforeUnmount()` | â—‹    | ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è§£é™¤      |

---

## âœ… JSDoc ã‚³ãƒ¡ãƒ³ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä»˜ã

```ts
/**
 * @lifecycle mounted
 * @description åˆæœŸè¡¨ç¤ºå®Œäº†å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚APIå–å¾—ã‚„focusãªã©ã«ä½¿ç”¨ã€‚
 */
mounted() {
  console.log('åˆæœŸè¡¨ç¤ºå®Œäº†')
}

/**
 * @lifecycle beforeUnmount
 * @description DOMç ´æ£„å‰ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‡¦ç†ã‚’è¨˜è¿°
 */
beforeUnmount() {
  console.log('å¾Œå‡¦ç†å®Ÿè¡Œ')
}
```

---

## âœ… Composition APIã¨ã®é•ã„ï¼ˆå‚è€ƒï¼‰

| è¦³ç‚¹        | ã‚ªãƒ—ã‚·ãƒ§ãƒ³API      | Composition APIï¼ˆsetupå†…ï¼‰ |
| --------- | ------------- | ----------------------- |
| mounted   | `mounted()`   | `onMounted(() => {})`   |
| unmounted | `unmounted()` | `onUnmounted(() => {})` |

---

## âœ… ã‚ˆãã‚ã‚‹å¿œç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

| ç›®çš„          | ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«                         | å†…å®¹                        |
| ----------- | ------------------------------- | ------------------------- |
| APIåˆæœŸå–å¾—     | `mounted()`                     | axios ã§ãƒªã‚¹ãƒˆå–å¾—              |
| WebSocketæ¥ç¶š | `mounted()` + `beforeUnmount()` | æ¥ç¶šã¨åˆ‡æ–­                     |
| ã‚­ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²    | `mounted()` + `beforeUnmount()` | `window.addEventListener` |

---

## âœ… ã¾ã¨ã‚

| ã‚¿ã‚¤ãƒŸãƒ³ã‚° | ãƒ•ãƒƒã‚¯å              |
| ----- | ----------------- |
| åˆæœŸåŒ–å‰  | `beforeCreate`    |
| åˆæœŸåŒ–å¾Œ  | `created`         |
| è¡¨ç¤ºç›´å‰  | `beforeMount`     |
| è¡¨ç¤ºå¾Œ   | `mounted` âœ… æœ€ã‚‚ä½¿ã†  |
| æ›´æ–°å‰   | `beforeUpdate`    |
| æ›´æ–°å¾Œ   | `updated`         |
| ç ´æ£„å‰   | `beforeUnmount` âœ… |
| ç ´æ£„å¾Œ   | `unmounted`       |

---

## ğŸ” æ¬¡ã«è¦‹ã‚‹ã¨è‰¯ã„ãƒˆãƒ”ãƒƒã‚¯

* âœ… `mounted` + `watch` + `axios` ã®é€£æºä¾‹
* âœ… `beforeUnmount` ã§ã® WebSocket ã‚„ã‚¤ãƒ™ãƒ³ãƒˆè§£é™¤ãƒ‘ã‚¿ãƒ¼ãƒ³
* âœ… Composition API ã¨ã®æ¯”è¼ƒï¼ˆå¿…è¦ã‚ã‚Œã°ï¼‰

ã©ã®æ–¹å‘ã«é€²ã‚ã¾ã—ã‚‡ã†ã‹ï¼Ÿã¾ãŸã¯ã“ã®å†…å®¹ã‚’é››å½¢ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã—ã¦æä¾›ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

äº†è§£ã—ã¾ã—ãŸï¼ã“ã“ã§ã¯ã€Vue 3 + TypeScript + ã‚ªãƒ—ã‚·ãƒ§ãƒ³APIï¼ˆ`defineComponent`ï¼‰ã‚’ä½¿ã£ã¦ã€

### âœ… `mounted` + `watch` + `axios` ã‚’çµ„ã¿åˆã‚ã›ã¦å‹•çš„ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹å®Ÿä¾‹

ã‚’ä½œæˆã—ã¾ã™ã€‚
Vuetifyã®UIã¨çµ„ã¿åˆã‚ã›ã¦ã€**ã€Œå…¥åŠ›å€¤ãŒå¤‰æ›´ã•ã‚Œã‚‹ãŸã³ã«APIã‚’å©ãã€çµæœã‚’è¡¨ç¤ºã€** ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚

---

## ğŸ§© ã‚·ãƒŠãƒªã‚ªä¾‹

* åˆæœŸè¡¨ç¤ºæ™‚ï¼ˆ`mounted`ï¼‰ã« `keyword` ã«åˆæœŸå€¤ã‚’è¨­å®š
* `watch` ã§ `keyword` ã®å¤‰åŒ–ã‚’ç›£è¦–ã—ã¦ `axios` ã§ API ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
* çµæœã‚’è¡¨ç¤ºï¼ˆãƒªã‚¹ãƒˆï¼‰

---

## âœ… å®Ÿè£…ä¾‹ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼åæ¤œç´¢APIã®æƒ³å®š

```vue
<template>
  <div style="width: 400px;">
    <v-text-field
      v-model="keyword"
      label="ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›"
    />
    <v-list>
      <v-list-item
        v-for="(item, index) in results"
        :key="index"
        :title="item.name"
        :subtitle="item.email"
      />
    </v-list>
  </div>
</template>

<script lang="ts">
import { defineComponent, watch } from 'vue'
import axios from 'axios'
import {
  VTextField,
  VList,
  VListItem
} from 'vuetify/components'

interface User {
  name: string
  email: string
}

export default defineComponent({
  name: 'UserSearch',

  components: {
    VTextField,
    VList,
    VListItem
  },

  data() {
    return {
      keyword: '',
      results: [] as User[]
    }
  },

  mounted() {
    console.log('ğŸ“Œ mounted: åˆæœŸåŒ–å®Œäº†')
    this.keyword = 'åˆæœŸãƒ¦ãƒ¼ã‚¶ãƒ¼'
  },

  watch: {
    /**
     * @watch keyword
     * @param {string} newVal - å…¥åŠ›ã•ã‚ŒãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
     * @description ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®å¤‰æ›´ã”ã¨ã«æ¤œç´¢APIã‚’å‘¼ã³å‡ºã™
     */
    async keyword(newVal: string) {
      if (!newVal) {
        this.results = []
        return
      }

      try {
        const res = await axios.get(`/api/users?name=${encodeURIComponent(newVal)}`)
        this.results = res.data
      } catch (e) {
        console.error('âŒ ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ã«å¤±æ•—:', e)
        this.results = []
      }
    }
  }
})
</script>
```

---

## âœ… è§£èª¬ãƒã‚¤ãƒ³ãƒˆ

| æ§‹æˆ              | èª¬æ˜                                 |
| --------------- | ---------------------------------- |
| `mounted()`     | åˆæœŸåŒ–å¾Œã« `keyword` ã«åˆæœŸå€¤ã‚’è¨­å®šï¼ˆwatchãŒå³ç™ºç«ï¼‰ |
| `watch.keyword` | å…¥åŠ›ãŒå¤‰ã‚ã‚‹ãŸã³ã«APIå‘¼ã³å‡ºã—ï¼ˆ`axios.get`ï¼‰      |
| `v-model`       | å…¥åŠ›ã¨ `keyword` ã‚’åŒæ–¹å‘ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°          |
| `v-for`         | çµæœã‚’ãƒªã‚¹ãƒˆã¨ã—ã¦è¡¨ç¤º                        |

---

## ğŸ§  å¿œç”¨ã‚¢ã‚¤ãƒ‡ã‚¢

| æ©Ÿèƒ½        | å®Ÿè£…æ–¹æ³•                                       |
| --------- | ------------------------------------------ |
| é€šä¿¡å›æ•°ã®æŠ‘åˆ¶   | `debounce`ï¼ˆ`lodash.debounce`ã‚„setTimeoutï¼‰   |
| é€šä¿¡ã‚­ãƒ£ãƒ³ã‚»ãƒ«   | `AbortController` ã¾ãŸã¯ `axios.CancelToken`  |
| åˆæœŸè¡¨ç¤ºæ™‚ã«ã‚‚æ¤œç´¢ | `mounted()` ã§ `keyword` ã‚’åˆæœŸè¨­å®šï¼ˆâ†’ watch ãŒåå¿œï¼‰ |

---

## âœ… ã¾ã¨ã‚

| æ©Ÿèƒ½     | ä½¿ç”¨ç®‡æ‰€                               |
| ------ | ---------------------------------- |
| åˆæœŸåŒ–    | `mounted()`                        |
| å€¤ã®å¤‰åŒ–ç›£è¦– | `watch: { keyword() { ... } }`     |
| é€šä¿¡å‡¦ç†   | `axios.get()`ï¼ˆéåŒæœŸå¯¾å¿œï¼‰               |
| è¡¨ç¤ºUI   | `v-model`, `v-list`, `v-list-item` |

---

ã”å¸Œæœ›ãŒã‚ã‚Œã°ï¼š

* âœ… debounce + axios ã®çµ„ã¿åˆã‚ã›ä¾‹
* âœ… Composition API ç‰ˆã¨ã®æ¯”è¼ƒ
* âœ… APIé€šä¿¡ã®æˆåŠŸãƒ»å¤±æ•—ãƒ•ãƒ©ã‚°ã§UIåˆ‡ã‚Šæ›¿ãˆï¼ˆãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºï¼‰

ã©ã‚Œã‚’è¦‹ã¦ã¿ãŸã„ã§ã™ã‹ï¼Ÿ

ã¨ã¦ã‚‚è‰¯ã„è³ªå•ã§ã™ï¼Vue 3ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³APIï¼‰ã«ãŠã„ã¦ã€**`watch` ã‚’ `setup()` ã‚„ `mounted()` ã®ä¸­ã«æ›¸ã‹ãšã«ã€Œã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ç›´æ¥æ›¸ãã€å ´åˆ**ã®æŒ™å‹•ã«ã¤ã„ã¦ã€æ˜ç¢ºã«è§£èª¬ã—ã¾ã™ã€‚

---

## âœ… çµè«–

### Vue 3 ã® **ã‚ªãƒ—ã‚·ãƒ§ãƒ³API** ã§ã¯ï¼š

```ts
watch: {
  keyword(newVal) {
    // ã“ã‚Œã¯æ­£ã—ãå‹•ä½œã—ã¾ã™ï¼
  }
}
```

ã“ã‚Œã¯**å…¬å¼ã«ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹æ­£ã—ã„æ§‹æ–‡**ã§ã‚ã‚Šã€**Vue 2 ã¨åŒæ§˜ã«**å‹•ãã¾ã™ã€‚
**setup ã‚„ mounted ã«æ›¸ã‹ãªãã¦ã‚‚ã€Vue ãŒè‡ªå‹•ã§ç›£è¦–ã‚’ç™»éŒ²**ã—ã¦ãã‚Œã¾ã™ã€‚

---

## âœ… ã“ã®æ›¸ãæ–¹ã®ç‰¹å¾´

| æ›¸ãæ–¹                              | å‹•ä½œ                    | ä½¿ã„ã©ã“ã‚                        |
| -------------------------------- | --------------------- | ---------------------------- |
| `watch: { xxx(newVal) { ... } }` | Vue ãŒè‡ªå‹•ç™»éŒ²             | å˜ä¸€ã®ãƒ‡ãƒ¼ã‚¿ã‚„computedã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«ç›£è¦–ã—ãŸã„ã¨ã |
| `watch(() => ..., handler)`      | setup/mountedå†…ã§æ˜ç¤ºçš„ã«ç›£è¦– | è¤‡æ•°ã®å€¤ã‚’ä¸€æ‹¬ç›£è¦–ã€æ¡ä»¶ä»˜ãã€å¤–éƒ¨é–¢æ•°åŒ–ã—ãŸã„ã¨ã    |

---

## âœ… ä½¿ç”¨ä¾‹ï¼ˆãƒ«ãƒ¼ãƒˆã® `watch` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‰

```ts
export default defineComponent({
  data() {
    return {
      keyword: ''
    }
  },

  watch: {
    keyword(newVal: string, oldVal: string) {
      console.log('keyword changed:', oldVal, 'â†’', newVal)
    }
  }
})
```

ã“ã‚Œã¯ Vue ã«ã‚ˆã‚Šã€**ã“ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒä½œæˆã•ã‚Œã‚‹ã¨åŒæ™‚ã«** `keyword` ã®ç›£è¦–ãŒã‚»ãƒƒãƒˆã•ã‚Œã€**ãã®å¾Œã‚‚ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ç›£è¦–ã•ã‚Œç¶šã‘ã¾ã™**ã€‚

---

## âœ… `mounted()` å†…ã§ `watch()` ã‚’ä½¿ã†ã®ã¯ãªãœï¼Ÿ

ãã‚Œã¯ **æ¬¡ã®ã‚ˆã†ãªç‰¹æ®Šãªã‚±ãƒ¼ã‚¹ã«å¯¾å¿œã™ã‚‹ãŸã‚**ã§ã™ï¼š

| ç›®çš„                                     | å¿…è¦ãªæ›¸ãæ–¹                            |
| -------------------------------------- | --------------------------------- |
| `watch(() => computedValue)` ã®ã‚ˆã†ãªæŸ”è»Ÿãªç›£è¦– | `watch()` é–¢æ•°ã§å®šç¾©ã™ã‚‹ï¼ˆsetup/mountedå†…ï¼‰ |
| é…åˆ—ãƒ»è¤‡æ•°ãƒ»å¤–éƒ¨å¤‰æ•°ã«ä¾å­˜ã™ã‚‹ç›£è¦–                      | `watch(() => [a, b], handler)`    |
| å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å‹•çš„ã«watchã‚’è¿½åŠ                     | `watch()` ã‚’é–¢æ•°å†…ã§å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚‹          |

---

## âœ… ã¾ã¨ã‚

| è³ªå•                                        | å›ç­”                                             |
| ----------------------------------------- | ---------------------------------------------- |
| `watch` ã¯ `setup` ã‚„ `mounted` ã«æ›¸ã‹ãªã„ã¨å‹•ã‹ãªã„ï¼Ÿ | âŒ ãã‚“ãªã“ã¨ã¯ãªã„ã€‚ãƒ«ãƒ¼ãƒˆã« `watch: {}` ã¨ã—ã¦æ›¸ã‘ã°OKï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³APIï¼‰ |
| ã§ã¯ `mounted()` å†…ã«æ›¸ãã®ã¯ï¼Ÿ                    | ã‚ˆã‚Šå‹•çš„ãƒ»æŸ”è»Ÿãª `watch()` è¨˜è¿°ãŒå¿…è¦ãªã¨ãã ã‘                  |
| ã©ã£ã¡ã‚’ä½¿ãˆã°ï¼Ÿ                                  | å˜ç´”ãªã‚‰ `watch: {}`ã€è¤‡é›‘ãªã‚‰ `watch()` é–¢æ•°ã‚’ä½¿ã†          |

---

æ¬¡ã«è¦‹ãŸã„ã®ã¯ï¼š

* âœ… `watch` ã« `immediate: true` ã‚’ä½¿ã£ã¦åˆå›ã‹ã‚‰å®Ÿè¡Œã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³
* âœ… `deep: true` ã‚’ä½¿ã£ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’ç›£è¦–ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³
* âœ… `unwatch` ã§å‹•çš„ã«ç›£è¦–è§£é™¤ã™ã‚‹å¿œç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

ã©ã‚Œã‚’ã”å¸Œæœ›ã§ã™ã‹ï¼Ÿ
